<!DOCTYPE html>
<html lang="ko">
<head>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-KNL2VQN');</script>
  <!-- End Google Tag Manager -->

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-218993952-1">
  </script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-218993952-1');

    if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('serviceWorker.js')
      .then((reg) => {
        console.log('Service Worker Registered!', reg);
      });
    }
  </script>

  <title>마이리얼MBTI랭커스</title>
  <meta property="og:type" content="website">
  <meta property="og:title" content="마이리얼MBTI랭커스">
  <meta property="og:description" content="내 MBTI랑 어울리는 아파트 단지는?">
  <meta property="og:image" content="https://www.realrankus.com/mbti/thumbnail_MBTI.png">
  <meta property="og:url" content="https://www.realrankus.com/mbti/">
  <meta name="keyword" content="부동산, 아파트, 입지, 순위, 아파트입지, 우리동네, 호가, 대장아파트, 최고가, 신고가, 호재, AI, 등수">
  <meta name="description" content="마이리얼MBTI랭커스">
  <meta name="author" content="리얼랭커스">
  <meta name="robots" content="index,follow">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui, viewport-fit=cover">

  <!-- 주소창 등의 웹 브라우저 UI를 표시하지 않기 -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <!-- 상태 바의 스타일을 지정 -->
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="theme-color" content="#fff">
  <!-- 홈 화면에서 표시되는 앱 이름을 지정 -->
  <meta name="apple-mobile-web-app-title" content="마이리얼MBTI랭커스">
  <!-- 홈 화면에서 표시되는 앱 아이콘을 지정 -->
  <link rel="apple-touch-icon" href="https://www.realrankus.com/mbti/apt-rank-MBTI-152x152.png">
  <!-- 웹 앱 매니페스트를 읽어 들이기 -->
  <link rel="manifest" href="manifest_mbti.json">  

  <link rel="canonical" href="https://www.realrankus.com/mbti/">
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@mdi/font@6.x/css/materialdesignicons.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <link rel="shortcut icon" href="https://www.realrankus.com/mbti/apt-rank-MBTI.png"/>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.min.js"  crossorigin="anonymous"></script>
  <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>  
  <script src="https://static.nid.naver.com/js/naveridlogin_js_sdk_2.0.2.js" charset="utf-8"></script>  
  <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>  

  <script src="./menu_select_box.js" type="text/javascript"></script>
  <script src="../js/draw_chart.js" type="text/javascript"></script>      
  <script src="../js/share.js" type="text/javascript"></script>
  <script src="../js/distance.js" type="text/javascript"></script>  
  <script src="./mbti_wording.js" type="text/javascript"></script>

  <link href="../css/style_common.css" rel="stylesheet"/>
  <link href="./style_mbti.css" rel="stylesheet"/>
  <link href="../css/slider.css" rel="stylesheet"/>
  <link href="../css/distance.css" rel="stylesheet"/>

  <script src="../js/doubleSlider.js" type="text/javascript"></script>
</head>
<style>
</style>

<body ontouchstart="">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNL2VQN"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->  

  <div id="container">
    <div id="centerBox">
      <div id="titleBar_theme">
        <div id='themeShare'></div>        
        <div id="rearrange"></div>
        <div id="title">마이리얼MBTI랭커스<span style="font-size: 0.6em; color:#ccc; font-weight: 400;"> powered by 리얼랭커스</span></div>
        <div id="guide_and_search"></div>
        <div id="help"></div>
      </div>      

      <div id="MBTI_box">
          <div id="mbti_title">내 MBTI는요,</div>
          <div id="MBTI_result">          
            <div id="MBTI_text_wrapper">
              <div class="MBTI_text" id="MBTI_text_E_I">E</div>
              <div class="MBTI_text" id="MBTI_text_N_S">S</div>
              <div class="MBTI_text" id="MBTI_text_T_F">T</div>
              <div class="MBTI_text" id="MBTI_text_J_P">P</div>
            </div>   
            <div id="MBTI_description">---</div>
          </div>
      </div>

      <div id="MBTI_selection_box">        
          <div id="MBTI_selection_wrapper">
            <div class="MBTI_selection" id="selection_E_I">
              <div class="selection_slider_box">
                <div class="slider_text">
                  <div>E</div>
                  <div style="font-size: 0.5em">외향</div>                  
                </div>
                <div>
                  <input class="form-range" type="range" min="0" max="5" id="range_E_I" list="tickmarks" value="0" oninput = "setMBTIText(this)">
                  <datalist id="tickmarks">
                    <option value="0">●</option>
                    <option value="1">●</option>
                    <option value="2">●</option>
                    <option value="3">●</option>
                    <option value="4">●</option>
                    <option value="5">●</option>
                  </datalist>
                </div>
                <div class="slider_text">
                  <div>I</div>
                  <div style="font-size: 0.5em">내향</div>
                </div>
              </div>
            </div>
            <div class="MBTI_selection" id="selection_N_S">
              <div class="selection_slider_box">
                <div class="slider_text">
                  <div>N</div>
                  <div style="font-size: 0.5em">이상</div>
                </div>
                <div>
                  <input class="form-range" type="range" min="0" max="5" id="range_N_S" list="tickmarks" value="5" oninput = "setMBTIText(this)">
                  <datalist id="tickmarks">
                    <option value="0">●</option>
                    <option value="1">●</option>
                    <option value="2">●</option>
                    <option value="3">●</option>
                    <option value="4">●</option>
                    <option value="5">●</option>
                  </datalist>
                </div>
                <div class="slider_text">
                  <div>S</div>
                  <div style="font-size: 0.5em">현실</div>
                </div>                
              </div>
            </div>
            <div class="MBTI_selection" id="selection_T_F">
              <div class="selection_slider_box">
                <div class="slider_text">
                  <div>T</div>
                  <div style="font-size: 0.5em">논리</div>
                </div>
                <div>
                  <input class="form-range" type="range" min="0" max="5" id="range_T_F" list="tickmarks" value="0" oninput = "setMBTIText(this)">
                  <datalist id="tickmarks">
                    <option value="0">●</option>
                    <option value="1">●</option>
                    <option value="2">●</option>
                    <option value="3">●</option>
                    <option value="4">●</option>
                    <option value="5">●</option>
                  </datalist>
                </div>
                <div class="slider_text">
                  <div>F</div>
                  <div style="font-size: 0.5em">감성</div>
                </div>                
              </div>              
            </div>
            <div class="MBTI_selection" id="selection_J_P">
              <div class="selection_slider_box">
                <div class="slider_text">
                  <div>J</div>
                  <div style="font-size: 0.5em">계획</div>
                </div>
                <div>
                  <input class="form-range" type="range" min="0" max="5" id="range_J_P" list="tickmarks" value="5" oninput = "setMBTIText(this)">
                  <datalist id="tickmarks">
                    <option value="0">●</option>
                    <option value="1">●</option>
                    <option value="2">●</option>
                    <option value="3">●</option>
                    <option value="4">●</option>
                    <option value="5">●</option>
                  </datalist>
                </div>
                <div class="slider_text">
                  <div>P</div>
                  <div style="font-size: 0.5em">자율</div>
                </div>                
              </div>              
            </div>
          </div>

          <hr>

          <div id="mbti_find"></div>

          <div class="region_box">
            <div class="region_selection">
              <div class="sido_selection"><select class='sido' id="sido1" onChange="optionChange(this)"></select></div>
              <div class="gungu_selection"><select class='gungu' id="gungu1" onChange=""></select></div>
            </div>
            <div class="region_selection">
              <div class="sido_selection"><select class='sido' id="sido2" onChange="optionChange(this)"></select></div>
              <div class="gungu_selection"><select class='gungu' id="gungu2" onChange=""></select></div>
            </div>
            <!--
            <div class="region_selection">
              <div class="sido_selection"><select class='sido' id="sido3" onChange="optionChange(this)"></select></div>
              <div class="gungu_selection"><select class='gungu' id="gungu3" onChange=""></select></div>
            </div>
            -->
          </div>

          <div id="generate" onClick = "generateMBTIComplex()"></div>
        </div>       
      </div>

      <!--리얼랭커스 연결      
      <div id="linkToAptrank_bottom"></div> -->

    </div>
  </div>

  <!-- Vertically centered scrollable modal -->
  <!-- Button trigger modal -->
  <!-- Modal -->
  <div class="modal fade" id="resultModal" tabindex="-1" aria-labelledby="resultModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="resultModalLabel">Modal title</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id='MBTI_detail'></div>
        <div id='footer'></div>
      </div>
    </div>
  </div>

  <!-- Toggle Modal -->
  <div class="modal fade" id="toggleModal1" tabindex="-1" aria-labelledby="toggleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="toggleModalLabel">Modal title</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id='distanceDetail'></div>
        <div id='toggle1footer'></div>
      </div>
    </div>
  </div>
  <div class="modal fade" id="toggleModal2" tabindex="-1" aria-labelledby="toggleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="toggleModalLabel">Modal title</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id='distanceDetail'></div>
        <div id='footer'></div>
      </div>
    </div>
  </div>

  <!-- Offcanvas Right -->
  <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight" aria-labelledby="offcanvasRightLabel">
    <div class="offcanvas-header">
      <h5 id="offcanvasRightLabel">MENU</h5>
      <button type="button" class="btn-close text-reset btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body"></div>
  </div>

  <!-- Offcanvas Profile -->
  <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasProfile" aria-labelledby="offcanvasProfileLabel">
    <div class="offcanvas-header">
      <h5 id="offcanvasRightLabel"></h5><i class="fa-solid fa-xmark"></i>
    </div>
    <div class="offcanvas-body"></div>
  </div>  

  <!-- Login Modal -->
  <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="loginModalLabel">Modal title</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="loginDetail"></div>
        <div id="loginfooter"></div>
      </div>
    </div>
  </div>  

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.0.0/dist/chart.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>

  <script src="https://www.gstatic.com/firebasejs/8.8.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.8.1/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.8.1/firebase-auth.js"></script>  
  
  <script type="text/javascript" src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=uod39kursd"></script>

</body>

<script src="../js/login_240308.js" type="text/javascript"></script>
<script src="../js/apple.js" type="text/javascript"></script>
<script type="module" src="../js/con_counter.js"></script>

<script>
  var selectedRegion = "Seoul"
  var selectedSubRegion = "1168000000_Seoul_Gangnam"  
  var currentMonth = "202409"; //수정 
  var blank_height = "3em"

  var pageName = "aptrank_MBTI" //20231020  

  var regionName = ""
  var regionValue = ""

  var currentMenu = ""

  var popMsg = "클립보드에 복사되었습니다."

  var EI_val = 0
  var NS_val = 0
  var TF_val = 0
  var JP_val = 0
  var MBTI_word = ""
  var MBTI_color = ""

  var today = new Date()
  var today_year = today.getFullYear();
  var today_month = dateReturn( (today.getMonth() + 1))
  var today_day = dateReturn( today.getDate() );
  var today_num = Number("" + today_year + today_month + today_day)
  var today_str = today_year + "-" + today_month + "-" + today_day

  function dateReturn(n){
    return n<10 ? "0"+n : n
  }

  $(document).ready(function(){

    Kakao.init(kakaoKey);

    var option_default = ""
    for(i = 1 ; i < regions.length ; i++){
        option_default += "<option value='" + regions[i][1] + "'>" + regions[i][0] + "</option>"
    }
    $('#sido1').html(option_default)
    optionChange( document.getElementById('sido1') )
    
    var option = ""
    for(i = 0 ; i < regions.length ; i++){
        option += "<option value='" + regions[i][1] + "'>" + regions[i][0] + "</option>"
    }

    $('#sido2').html(option)
    //$('#sido3').html(option)
    optionChange( document.getElementById('sido2') )
    //optionChange( document.getElementById('sido3') )

    $('div.modal').on('show.bs.modal', function() {
      var modal = this;
      var hash = modal.id;
      window.location.hash = hash;
      window.onhashchange = function() {
        if (!location.hash){
          $(modal).modal('hide');
        }
      }
    });

    $('div.modal').on('hidden.bs.modal', function() {
      var hash = this.id;
      history.replaceState('', document.title, window.location.pathname);
    })

    if(UserAgent.indexOf("inApp")>-1){
      if(checkMobile() == "ios"){
        shareHtml = "<div class='toShare' onClick='CopyToClipboard(shareText, popMsg)'><i class='fa-regular fa-copy'></i></div>"
      }
      else{
        shareHtml = "<div class='tShare' onClick='kakaoShare(shareTitle, shareText, shareURL)'><img src=\"kakao_icon.png\" height=\"28px\"/></div>"
      }
    }
    else{
      shareHtml = "<div class='tShare' onClick='share(shareTitle, shareText, shareURL)'><i class='fa-solid fa-arrow-up-right-from-square'></i></div>"      
    }

    currentMenu = "aptrank_MBTI"  //offcanvas  
    setOffcanvasMenu() //offcanvas
    if(!isMobile){
      $("#linkToAptrank_bottom").css({'width':'800px', 'margin':'0 auto'})
    }

    setMBTIText( document.getElementById('range_E_I'))
    setMBTIText( document.getElementById('range_N_S') )
    setMBTIText( document.getElementById('range_T_F') )
    setMBTIText( document.getElementById('range_J_P') )
  });

  function setMBTIText(obj){
    selection = obj.id
    selected_val = obj.value
    selected_id = ""
    selected_word = ""

    if(selection == "range_E_I"){
      EI_val = selected_val
      selected_id = "MBTI_text_E_I"
      if(selected_val >= 0 && selected_val <= 2){ selected_word = "E" }
      else{ selected_word = "I" }
    }

    if(selection == "range_N_S"){
      NS_val = selected_val
      selected_id = "MBTI_text_N_S"
      if(selected_val >= 0 && selected_val <= 2){ selected_word = "N" }
      else{ selected_word = "S" }
    }

    if(selection == "range_T_F"){
      TF_val = selected_val
      selected_id = "MBTI_text_T_F"
      if(selected_val >= 0 && selected_val <= 2){ selected_word = "T" }
      else{ selected_word = "F" }
    }

    if(selection == "range_J_P"){
      JP_val = selected_val
      selected_id = "MBTI_text_J_P"
      if(selected_val >= 0 && selected_val <= 2){ selected_word = "J" }
      else{ selected_word = "P" }
    }

    if(selected_val == 0 || selected_val == 5){
      selected_opacity = "1.0"
    }
    if(selected_val == 1 || selected_val == 4){
      selected_opacity = "0.7"
    }
    if(selected_val == 2 || selected_val == 3){
      selected_opacity = "0.4"
    }    

    $("#" + selected_id).html(selected_word)
    $("#" + selected_id).css({"opacity" : selected_opacity})

    MBTI_word = $("#MBTI_text_E_I").html() + $("#MBTI_text_N_S").html() + $("#MBTI_text_T_F").html() + $("#MBTI_text_J_P").html()

    MBTI_color = ""

    if(MBTI_word == "INTJ" || MBTI_word == "INTP" || MBTI_word == "ENTJ" || MBTI_word == "ENTP"){
      MBTI_color = "#68119e"
    }
    if(MBTI_word == "INFJ" || MBTI_word == "INFP" || MBTI_word == "ENFJ" || MBTI_word == "ENFP"){
      MBTI_color = "#119e50"
    }
    if(MBTI_word == "ISTJ" || MBTI_word == "ISFJ" || MBTI_word == "ESTJ" || MBTI_word == "ESFJ"){
      MBTI_color = "#11849e"
    }
    if(MBTI_word == "ISTP" || MBTI_word == "ISFP" || MBTI_word == "ESTP" || MBTI_word == "ESFP"){
      MBTI_color = "#ED8618"
    }

    $("#MBTI_description").html("- " + mbti_result_des[MBTI_word] + " -")
    $(".MBTI_text").css({"color" : MBTI_color})
    $("#MBTI_description").css({"color" : MBTI_color})

    $("#titleBar_theme").css({"background" : MBTI_color})
    $("#generate").css({"background" : MBTI_color})

    $("#mbti_find").html(MBTI_word + "와 어울리는 단지를 찾아볼까요?")
    $("#generate").html(MBTI_word + "와 어울리는 단지 찾기")    
  }

  function scrollUp(){
    $( 'html, body' ).animate( { scrollTop : 0 }, 50 );
  }

function optionChange(selection){
    sido_id = selection.id
    gungu_id = ""
    if(sido_id == "sido1"){
      gungu_id = "gungu1"
    }
    if(sido_id == "sido2"){
      gungu_id = "gungu2"
    }
    if(sido_id == "sido3"){
      gungu_id = "gungu3"
    }

    regionName = $("#" + sido_id + " option:selected").val();

    var changeItem
    if(regionName == 'Seoul'){
      changeItem = inSeoul
    }
    if(regionName == 'Busan'){
      changeItem = inBusan
    }
    if(regionName == 'Incheon'){
      changeItem = inIncheon
    }
    if(regionName == 'Daegu'){
      changeItem = inDaegu
    }
    if(regionName == 'Gwangju'){
      changeItem = inGwangju
    }
    if(regionName == 'Daejeon'){
      changeItem = inDaejeon
    }
    if(regionName == 'Ulsan'){
      changeItem = inUlsan
    }
    if(regionName == 'Sejong'){
      changeItem = inSejong
    }
    if(regionName == 'Gyeonggi'){
      changeItem = inGyeonggi
    }
    if(regionName == 'Gangwondo'){
      changeItem = inNewGangwondo
    }
    if(regionName == 'Chungcheongbukdo'){
      changeItem = inChungcheongbukdo
    }
    if(regionName == 'Chungcheongnamdo'){
      changeItem = inChungcheongnamdo
    }
    if(regionName == 'Jeollabukdo'){
      changeItem = inJeollabukdo
    }
    if(regionName == 'Jeollanamdo'){
      changeItem = inJeollanamdo
    }
    if(regionName == 'Gyeongsangbukdo'){
      changeItem = inGyeongsangbukdo
    }
    if(regionName == 'Gyeongsangnamdo'){
      changeItem = inGyeongsangnamdo
    }
    if(regionName == 'Jejudo'){
      changeItem = inJejudo
    }
    if(regionName == 'none'){
      changeItem = []
    }
    $('#' + gungu_id).empty();

    if(changeItem.length <= 0){
      return
    }

    for(var i = 0 ; i < changeItem.length; i++){
      var subOption = $("<option value='" + changeItem[i][1] + "'>" + changeItem[i][0] + "</option>")
      $('#' + gungu_id).append(subOption);
    }
    $('#' + gungu_id).val(changeItem[0][1]).prop("selected", true);
  }

  var region1_list = []
  var region2_list = []

  function generateMBTIComplex(){
    $('body').append("<div id='pageLoadingBack'><div class='spinner-grow text-pageLoading' role='status'></div><div style='color: white'><br>" + MBTI_word + "에 어울리는 단지는요!!!</div></div>")

    //console.log("EI_val :", EI_val)
    //console.log("NS_val :", NS_val)
    //console.log("TF_val :", TF_val)
    //console.log("JP_val :", JP_val)

    EI_weight = ""
    if(EI_val == 0){ EI_weight = E3 }
    if(EI_val == 1){ EI_weight = E2 }
    if(EI_val == 2){ EI_weight = E1 }
    if(EI_val == 3){ EI_weight = I1 }
    if(EI_val == 4){ EI_weight = I2 }
    if(EI_val == 5){ EI_weight = I3 }

    NS_weight = ""
    if(NS_val == 0){ NS_weight = N3 }
    if(NS_val == 1){ NS_weight = N2 }
    if(NS_val == 2){ NS_weight = N1 }
    if(NS_val == 3){ NS_weight = S1 }
    if(NS_val == 4){ NS_weight = S2 }
    if(NS_val == 5){ NS_weight = S3 }

    TF_weight = ""
    if(TF_val == 0){ TF_weight = T3 }
    if(TF_val == 1){ TF_weight = T2 }
    if(TF_val == 2){ TF_weight = T1 }
    if(TF_val == 3){ TF_weight = F1 }
    if(TF_val == 4){ TF_weight = F2 }
    if(TF_val == 5){ TF_weight = F3 }
    
    JP_weight = ""
    if(JP_val == 0){ JP_weight = J3 }
    if(JP_val == 1){ JP_weight = J2 }
    if(JP_val == 2){ JP_weight = J1 }
    if(JP_val == 3){ JP_weight = P1 }
    if(JP_val == 4){ JP_weight = P2 }
    if(JP_val == 5){ JP_weight = P3 }

    //living_total = ( EI_weight['living'] + NS_weight['living'] + TF_weight['living'] + JP_weight['living'] ) / 100
    //trans_total = ( EI_weight['trans'] + NS_weight['trans'] + TF_weight['trans'] + JP_weight['trans'] ) / 100
    //infra_total = ( EI_weight['infra'] + NS_weight['infra'] + TF_weight['infra'] + JP_weight['infra'] ) / 100
    //edu_total = ( EI_weight['edu'] + NS_weight['edu'] + TF_weight['edu'] + JP_weight['edu'] ) / 100

    living_total = ( EI_weight['living'] * NS_weight['living'] * TF_weight['living'] * JP_weight['living'] )
    trans_total = ( EI_weight['trans'] * NS_weight['trans'] * TF_weight['trans'] * JP_weight['trans'] )
    infra_total = ( EI_weight['infra'] * NS_weight['infra'] * TF_weight['infra'] * JP_weight['infra'] )
    edu_total = ( EI_weight['edu'] * NS_weight['edu'] * TF_weight['edu'] * JP_weight['edu'] )

    //console.log("LIVING:", living_total)
    //console.log("TRANS:", trans_total)
    //console.log("INFRA:", infra_total)
    //console.log("EDU:", edu_total)

    url1 = "https://www.realrankus.com/" + currentMonth + "/" + $("#gungu1").val() + ".json"
    url2 = $("#gungu2").val()
    url3 = $("#gungu3").val()

    $.getJSON(url1, function (json) {
      aptData = json;
      apt_list = aptData.data;
    })
    .done(function(){
      //console.log(apt_list)
      region1_list = calculate_mbti_complex(apt_list, living_total, trans_total, infra_total, edu_total)
      if(url2 != null){
        url2 = "https://www.realrankus.com/" + currentMonth + "/" + $("#gungu2").val() + ".json"
        $.getJSON(url2, function (json) {
          aptData2 = json;
          apt_list2 = aptData2.data;
        })
        .done(function(){
          region2_list = calculate_mbti_complex(apt_list2, living_total, trans_total, infra_total, edu_total)
          showResult()
        })
      }
      else{
        showResult()        
      }
    })
  }

  function calculate_mbti_complex(apt_list, living_total, trans_total, infra_total, edu_total){   

    for(var i = 0; i < apt_list.length ; i++){
      var living_val = apt_list[i]["주거총점"]
      var trans_val = apt_list[i]["교통총점"]
      var infra_val = apt_list[i]["인프라총점"]
      var edu_val = apt_list[i]["학군총점"]

      if(trans_val == "NA"){
        edu_val = 0
      }     

      var mbti_value = (living_val * living_total) + (trans_val * trans_total) + (infra_val * infra_total) + (edu_val * edu_total)
      apt_list[i]["MBTI_VAL"] = mbti_value
    }

    result = sortList(apt_list)
    filtered_list = result.filter(param => param["준공년차"] <= 20);  
    return filtered_list.slice(0, 10)
  }

  function showResult(){
    titleHtml = ""
    detailHtml = ""
    footerHtml = ""

    shareTitle = ""
    shareText = ""
    shareURL = ""

    selected_region1 = $("#sido1 option:selected").text() + " " + $("#gungu1 option:selected").text()
    selected_region2 = $("#sido2 option:selected").text() + " " + $("#gungu2 option:selected").text()

    titleHtml += "<span class='focusOn'>" + MBTI_word + "</span>인 당신은요,"
    $("#resultModalLabel").html(titleHtml);

    detailHtml += "<div class='comment'>" + mbti_result_comment[MBTI_word]["comment1"] + "</div>"
    detailHtml += "<div class='reference'> 출처: https://www.16personalities.com/ </div>"
    detailHtml += "<hr>"
    detailHtml += "<div class='comment'>" + mbti_result_comment[MBTI_word]["comment2"] + "</div>"
    detailHtml += "<hr>"

    detailHtml += "<div id='compatable_complex'><span class='focusOn'>" + MBTI_word + "</span>에게 잘 어울리는 단지는요,</div>"

    detailHtml += "<div class='recommend_region'>" + selected_region1 +"</div>"

    region1_share_text = "『" + selected_region1 + "』 " + "\n"

    for(var i = 0 ; i < 3 ; i++){
      if(region1_list.length == 0){
        detailHtml += "<div>" + selected_region1 + "에는 어울리는 단지가 없네요...</div>"
        break;
      }
      var aptName = region1_list[i]['아파트명']
      var aptDuration = region1_list[i]["준공년차"]
      var dong_address = region1_list[i]["법정동주소"]
      var searchCode = region1_list[i]["검색코드"]
      var house_num = region1_list[i]["세대수"]
      var coord_y = region1_list[i]["Y"]
      var coord_x = region1_list[i]["X"]
      var sURL = region1_list[i]["sURL"]
      var last_sales = aptData.data[i]["last_sales"].split(",");
      var last_sales_date = last_sales[0].toString();
      var last_sales_price = last_sales[1].toString();
      var last_sales_area = last_sales[2];
      last_sales_date_short = last_sales_date.substr(2);
      var living_val = region1_list[i]["주거총점"]
      var trans_val = region1_list[i]["교통총점"]
      var infra_val = region1_list[i]["인프라총점"]
      var edu_val = region1_list[i]["학군총점"]

      detailHtml += "<div class='recommended_complex_wrapper'>"

        detailHtml += "<div class='complex_info' id='complex_info_window'>"
          detailHtml += "<div class='subtitle_01'>" + aptName + "<span style='font-size:0.8em'> (" + aptDuration +"년차)</span></div>"        
          detailHtml += "<div class='comment_01'>" + dong_address + "</div>"
          detailHtml += "<div class='comment_02'>" + house_num.toLocaleString() + "세대 / <span class='aptPrice'>" + Math.round(last_sales_price / 100) / 100 + "억, " + last_sales_area + ", " + last_sales_date_short + "</span>" + "</div>"
          detailHtml += "<div class='mapView' id='mapView_1" + i + "' onClick='goMap(\"" + sURL + "\")'></div>"
        detailHtml += "</div>"
        
        detailHtml += "<div class='chart_canvas'><canvas id='chart_1" + i + "'></canvas></div>"
        detailHtml += "<div class='complex_link' onClick='goMap(\"" + sURL + "\")'>극T의 분석 정보가 궁금하다면? <i class='fa-solid fa-angles-right'></i></div>"
      detailHtml += "</div>"

      region1_share_text += "ㆍ" + aptName + " (" + aptDuration + "년차)" + "\n"      
    }
    detailHtml += "<div class='reference'>마이리얼MBTI랭커스에서 표현되는 단지는 투자지표가 아님을 말씀드리며, 투자 판단에 대한 모든 책임은 본인에게 있습니다.</div>"
    $('#MBTI_detail').html(detailHtml);    

    region2_share_text = ""

    if(region2_list.length > 0){
      detailHtml += "<hr>"
      detailHtml += "<div class='recommend_region'>" + selected_region2 +"</div>"

      region2_share_text = "『" + selected_region2 + "』 " + "\n"

      for(var i = 0 ; i < 3 ; i++){
        //console.log(region2_list)
        if(!region2_list[i]){          
          break;
        }
        var aptName = region2_list[i]['아파트명']
        var aptDuration = region2_list[i]["준공년차"]
        var dong_address = region2_list[i]["법정동주소"]
        var searchCode = region2_list[i]["검색코드"]
        var house_num = region2_list[i]["세대수"]
        var coord_y = region2_list[i]["Y"]
        var coord_x = region2_list[i]["X"]
        var sURL = region2_list[i]["sURL"]
        var last_sales = aptData.data[i]["last_sales"].split(",");
        var last_sales_date = last_sales[0].toString();
        var last_sales_price = last_sales[1].toString();
        var last_sales_area = last_sales[2];
        last_sales_date_short = last_sales_date.substr(2);
        var living_val = region2_list[i]["주거총점"]
        var trans_val = region2_list[i]["교통총점"]
        var infra_val = region2_list[i]["인프라총점"]
        var edu_val = region2_list[i]["학군총점"]

        detailHtml += "<div class='recommended_complex_wrapper'>"

          detailHtml += "<div class='complex_info' id='complex_info_window'>"
            detailHtml += "<div class='subtitle_01'>" + aptName + "<span style='font-size:0.8em'> (" + aptDuration +"년차)</span></div>"        
            detailHtml += "<div class='comment_01'>" + dong_address + "</div>"
            detailHtml += "<div class='comment_02'>" + house_num.toLocaleString() + "세대 / <span class='aptPrice'>" + Math.round(last_sales_price / 100) / 100 + "억, " + last_sales_area + ", " + last_sales_date_short + "</span>" + "</div>"
            detailHtml += "<div class='mapView' id='mapView_2" + i + "' onClick='goMap(\"" + sURL + "\")'></div>"
          detailHtml += "</div>"
          
          detailHtml += "<div class='chart_canvas'><canvas id='chart_2" + i + "'></canvas></div>"
        detailHtml += "</div>"

        region2_share_text += "ㆍ" + aptName + " (" + aptDuration + "년차)" + "\n"
      } 
      
      detailHtml += "<div class='reference'>마이리얼MBTI랭커스에서 표현되는 단지는 투자지표가 아님을 말씀드리며, 투자 판단에 대한 모든 책임은 본인에게 있습니다.</div>"
      $('#MBTI_detail').html(detailHtml);

      for(var i = 0 ; i < 3 ; i++){
        if(!region2_list[i]){          
          break;
        }
        var searchCode = region2_list[i]["검색코드"]
        var living_val = region2_list[i]["주거총점"]
        var trans_val = region2_list[i]["교통총점"]
        var infra_val = region2_list[i]["인프라총점"]
        var edu_val = region2_list[i]["학군총점"]
        var coord_y = region2_list[i]["Y"]
        var coord_x = region2_list[i]["X"]
        canvas_id = "chart_2" + i
        if(trans_val == "NA"){
          value_list = [living_val, infra_val, edu_val]
        }
        else{
          value_list = [living_val, trans_val, infra_val, edu_val]
        } 
        drawValueChart(canvas_id, value_list)
        map_id = "mapView_2" + i
        region_center = new naver.maps.LatLng(coord_y, coord_x)
        showMap(map_id, region_center, region2_list[i])
      }
    }

    for(var i = 0 ; i < 3 ; i++){
      if(!region1_list[i]){          
        break;
      }
      var searchCode = region1_list[i]["검색코드"]
      var living_val = region1_list[i]["주거총점"]
      var trans_val = region1_list[i]["교통총점"]
      var infra_val = region1_list[i]["인프라총점"]
      var edu_val = region1_list[i]["학군총점"]
      var coord_y = region1_list[i]["Y"]
      var coord_x = region1_list[i]["X"]
      canvas_id = "chart_1" + i
      if(trans_val == "NA"){
        value_list = [living_val, infra_val, edu_val]
      }
      else{
        value_list = [living_val, trans_val, infra_val, edu_val]
      }
      drawValueChart(canvas_id, value_list)
      map_id = "mapView_1" + i
      region_center = new naver.maps.LatLng(coord_y, coord_x)
      showMap(map_id, region_center, region1_list[i])
    }

    footerHtml += "<div id='modal_footer'>"
      footerHtml += "<div id='footer_btn_01' onClick='goMap(\"https://www.realrankus.com/\")'>극T스러운<br>전국 입지분석 보기</div>"
      if (navigator.userAgent.indexOf('KAKAO') >= 0){
        footerHtml += "<div id='footer_btn_02' onClick='kakaoShare2(shareTitle, shareText, shareURL)'>결과 공유하기</div>"
      }
      else{
        footerHtml += "<div id='footer_btn_02' onClick='share(shareTitle, shareText, shareURL)'>결과 공유하기</div>"
      }

      
    footerHtml += "</div>"

    shareURL = "https://www.realrankus.com/mbti"
    shareTitle += "마이리얼MBTI랭커스\n\n"
    shareText += MBTI_word + "인 당신은요," + "\n\n"
    shareText += mbti_result_comment_short[MBTI_word] + "\n\n"
    shareText += MBTI_word + "인 당신께 잘 어울리는 단지는요," + "\n\n"
    shareText += region1_share_text + "\n"
    if(region2_list.length > 0){
      shareText += region2_share_text + "\n"    
    }
    shareText += shareURL + "\n\n"
    shareText += "※\'마이리얼MBTI랭커스\'는 리얼랭커스의 입지 분석 정보를 사용합니다." + "\n"
    shareText += "https://www.realrankus.com/"

    $('#footer').html(footerHtml);
    $(".focusOn").css({"color" : MBTI_color})
    $(".complex_link").css({"color" : MBTI_color})

    $(".recommend_region").css({"background" : MBTI_color})
    $("#footer_btn_01").css({"background" : MBTI_color})
    $("#footer_btn_02").css({"background" : MBTI_color})    

    setTimeout(function(){
      $("#pageLoadingBack").remove()
      $("#resultModal").modal("show")
    }, 1000)    
  }

  function goMap(url){
    if(checkMobile() == "ios"){
      window.location.href = url
    }
    else{
      window.open(url)
    }      
  }
</script>
</html>
